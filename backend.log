INFO:     Will watch for changes in these directories: ['/Users/djtaylor/Desktop/procguard']
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
INFO:     Started reloader process [96044] using StatReload
Process SpawnProcess-1:
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
    self.run()
    ~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    ~~~~~~^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/uvicorn/server.py", line 67, in run
    return asyncio_run(self.serve(sockets=sockets), loop_factory=self.config.get_loop_factory())
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 719, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/uvicorn/server.py", line 71, in serve
    await self._serve(sockets)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/uvicorn/server.py", line 78, in _serve
    config.load()
    ~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/uvicorn/config.py", line 439, in load
    self.loaded_app = import_from_string(self.app)
                      ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/uvicorn/importer.py", line 19, in import_from_string
    module = importlib.import_module(module_str)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 1026, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/Users/djtaylor/Desktop/procguard/app/main.py", line 4, in <module>
    from app.api import batches, events, procedures, audit_timeline, compliance
  File "/Users/djtaylor/Desktop/procguard/app/api/batches.py", line 90, in <module>
    class EmailRequest(BaseModel):
    ...<3 lines>...
        attachments: Dict[str, bool]
  File "/Users/djtaylor/Desktop/procguard/app/api/batches.py", line 93, in EmailRequest
    message: Optional[str] = None
             ^^^^^^^^
NameError: name 'Optional' is not defined
WARNING:  StatReload detected changes in 'app/api/batches.py'. Reloading...
INFO:     Started server process [96096]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     127.0.0.1:63660 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:63725 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:63731 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 200 OK
INFO:     127.0.0.1:63731 - "GET /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 200 OK
INFO:     127.0.0.1:64012 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:64118 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:64548 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:64648 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:64652 - "GET /dashboard/summary HTTP/1.1" 200 OK
INFO:     127.0.0.1:64651 - "GET /dashboard/summary HTTP/1.1" 200 OK
INFO:     127.0.0.1:64651 - "GET /dashboard/summary HTTP/1.1" 200 OK
INFO:     127.0.0.1:64658 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 200 OK
INFO:     127.0.0.1:64659 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 200 OK
INFO:     127.0.0.1:64658 - "GET /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 200 OK
INFO:     127.0.0.1:64660 - "GET /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 200 OK
INFO:     127.0.0.1:64663 - "GET /violations/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:64663 - "GET /violations/09d2dd90-7578-442b-92f9-e9861d08d3b6?attach_context=true HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/pg8000/legacy.py", line 256, in execute
    self._context = self._c.execute_unnamed(
                    ~~~~~~~~~~~~~~~~~~~~~~~^
        statement, vals=vals, oids=self._input_oids, stream=stream
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/pg8000/core.py", line 723, in execute_unnamed
    self.handle_messages(context)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/pg8000/core.py", line 844, in handle_messages
    raise context.error
pg8000.exceptions.DatabaseError: {'S': 'ERROR', 'V': 'ERROR', 'C': 'P0001', 'M': 'Violations are immutable', 'W': 'PL/pgSQL function forbid_violation_mutation() line 3 at RAISE', 'F': 'pl_exec.c', 'L': '3919', 'R': 'exec_stmt_raise'}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/pg8000/legacy.py", line 283, in execute
    raise cls(msg)
pg8000.dbapi.ProgrammingError: {'S': 'ERROR', 'V': 'ERROR', 'C': 'P0001', 'M': 'Violations are immutable', 'W': 'PL/pgSQL function forbid_violation_mutation() line 3 at RAISE', 'F': 'pl_exec.c', 'L': '3919', 'R': 'exec_stmt_raise'}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/uvicorn/protocols/http/h11_impl.py", line 410, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/fastapi/applications.py", line 1135, in __call__
    await super().__call__(scope, receive, send)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/starlette/applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/fastapi/routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/fastapi/routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/fastapi/routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/fastapi/routing.py", line 245, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/starlette/concurrency.py", line 32, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/anyio/to_thread.py", line 63, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/anyio/_backends/_asyncio.py", line 2502, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/anyio/_backends/_asyncio.py", line 986, in run
    result = context.run(func, *args)
  File "/Users/djtaylor/Desktop/procguard/app/api/violations.py", line 86, in get_violation
    db.commit()
    ~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "<string>", line 2, in commit
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
    ~~~~~~~~~~~~~~~~~~^^
  File "<string>", line 2, in _prepare_impl
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
    ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
    ~~~~~~~~~~~^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
    ~~~~~~~~~~~^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self.mapper,
        ^^^^^^^^^^^^
        uow.states_for_mapper_hierarchy(self.mapper, False, False),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        uow,
        ^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        base_mapper,
        ^^^^^^^^^^^^
    ...<3 lines>...
        update,
        ^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        statement, multiparams, execution_options=execution_options
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/pg8000/legacy.py", line 283, in execute
    raise cls(msg)
sqlalchemy.exc.ProgrammingError: (pg8000.dbapi.ProgrammingError) {'S': 'ERROR', 'V': 'ERROR', 'C': 'P0001', 'M': 'Violations are immutable', 'W': 'PL/pgSQL function forbid_violation_mutation() line 3 at RAISE', 'F': 'pl_exec.c', 'L': '3919', 'R': 'exec_stmt_raise'}
[SQL: UPDATE violations SET triggering_filter_event_id=%s::UUID WHERE violations.violation_id = %s::UUID]
[parameters: (UUID('1c421378-01a1-4d3d-a7b5-35c010dc2a6c'), UUID('09d2dd90-7578-442b-92f9-e9861d08d3b6'))]
(Background on this error at: https://sqlalche.me/e/20/f405)
INFO:     127.0.0.1:64667 - "GET /violations/09d2dd90-7578-442b-92f9-e9861d08d3b6?attach_context=true HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/pg8000/legacy.py", line 256, in execute
    self._context = self._c.execute_unnamed(
                    ~~~~~~~~~~~~~~~~~~~~~~~^
        statement, vals=vals, oids=self._input_oids, stream=stream
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/pg8000/core.py", line 723, in execute_unnamed
    self.handle_messages(context)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/pg8000/core.py", line 844, in handle_messages
    raise context.error
pg8000.exceptions.DatabaseError: {'S': 'ERROR', 'V': 'ERROR', 'C': 'P0001', 'M': 'Violations are immutable', 'W': 'PL/pgSQL function forbid_violation_mutation() line 3 at RAISE', 'F': 'pl_exec.c', 'L': '3919', 'R': 'exec_stmt_raise'}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/pg8000/legacy.py", line 283, in execute
    raise cls(msg)
pg8000.dbapi.ProgrammingError: {'S': 'ERROR', 'V': 'ERROR', 'C': 'P0001', 'M': 'Violations are immutable', 'W': 'PL/pgSQL function forbid_violation_mutation() line 3 at RAISE', 'F': 'pl_exec.c', 'L': '3919', 'R': 'exec_stmt_raise'}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/uvicorn/protocols/http/h11_impl.py", line 410, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/fastapi/applications.py", line 1135, in __call__
    await super().__call__(scope, receive, send)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/starlette/applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/fastapi/routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/fastapi/routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/fastapi/routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/fastapi/routing.py", line 245, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/starlette/concurrency.py", line 32, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/anyio/to_thread.py", line 63, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/anyio/_backends/_asyncio.py", line 2502, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/anyio/_backends/_asyncio.py", line 986, in run
    result = context.run(func, *args)
  File "/Users/djtaylor/Desktop/procguard/app/api/violations.py", line 86, in get_violation
    db.commit()
    ~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "<string>", line 2, in commit
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
    ~~~~~~~~~~~~~~~~~~^^
  File "<string>", line 2, in _prepare_impl
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
    ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
    ~~~~~~~~~~~^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
    ~~~~~~~~~~~^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self.mapper,
        ^^^^^^^^^^^^
        uow.states_for_mapper_hierarchy(self.mapper, False, False),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        uow,
        ^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        base_mapper,
        ^^^^^^^^^^^^
    ...<3 lines>...
        update,
        ^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        statement, multiparams, execution_options=execution_options
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/pg8000/legacy.py", line 283, in execute
    raise cls(msg)
sqlalchemy.exc.ProgrammingError: (pg8000.dbapi.ProgrammingError) {'S': 'ERROR', 'V': 'ERROR', 'C': 'P0001', 'M': 'Violations are immutable', 'W': 'PL/pgSQL function forbid_violation_mutation() line 3 at RAISE', 'F': 'pl_exec.c', 'L': '3919', 'R': 'exec_stmt_raise'}
[SQL: UPDATE violations SET triggering_filter_event_id=%s::UUID WHERE violations.violation_id = %s::UUID]
[parameters: (UUID('1c421378-01a1-4d3d-a7b5-35c010dc2a6c'), UUID('09d2dd90-7578-442b-92f9-e9861d08d3b6'))]
(Background on this error at: https://sqlalche.me/e/20/f405)
INFO:     127.0.0.1:64673 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:64674 - "GET /violations/09d2dd90-7578-442b-92f9-e9861d08d3b6?attach_context=true HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/pg8000/legacy.py", line 256, in execute
    self._context = self._c.execute_unnamed(
                    ~~~~~~~~~~~~~~~~~~~~~~~^
        statement, vals=vals, oids=self._input_oids, stream=stream
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/pg8000/core.py", line 723, in execute_unnamed
    self.handle_messages(context)
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/pg8000/core.py", line 844, in handle_messages
    raise context.error
pg8000.exceptions.DatabaseError: {'S': 'ERROR', 'V': 'ERROR', 'C': 'P0001', 'M': 'Violations are immutable', 'W': 'PL/pgSQL function forbid_violation_mutation() line 3 at RAISE', 'F': 'pl_exec.c', 'L': '3919', 'R': 'exec_stmt_raise'}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/pg8000/legacy.py", line 283, in execute
    raise cls(msg)
pg8000.dbapi.ProgrammingError: {'S': 'ERROR', 'V': 'ERROR', 'C': 'P0001', 'M': 'Violations are immutable', 'W': 'PL/pgSQL function forbid_violation_mutation() line 3 at RAISE', 'F': 'pl_exec.c', 'L': '3919', 'R': 'exec_stmt_raise'}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/uvicorn/protocols/http/h11_impl.py", line 410, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/fastapi/applications.py", line 1135, in __call__
    await super().__call__(scope, receive, send)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/starlette/applications.py", line 107, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 63, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/fastapi/middleware/asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/starlette/routing.py", line 716, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/starlette/routing.py", line 736, in app
    await route.handle(scope, receive, send)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/starlette/routing.py", line 290, in handle
    await self.app(scope, receive, send)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/fastapi/routing.py", line 115, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/fastapi/routing.py", line 101, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/fastapi/routing.py", line 355, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/fastapi/routing.py", line 245, in run_endpoint_function
    return await run_in_threadpool(dependant.call, **values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/starlette/concurrency.py", line 32, in run_in_threadpool
    return await anyio.to_thread.run_sync(func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/anyio/to_thread.py", line 63, in run_sync
    return await get_async_backend().run_sync_in_worker_thread(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        func, args, abandon_on_cancel=abandon_on_cancel, limiter=limiter
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/anyio/_backends/_asyncio.py", line 2502, in run_sync_in_worker_thread
    return await future
           ^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/anyio/_backends/_asyncio.py", line 986, in run
    result = context.run(func, *args)
  File "/Users/djtaylor/Desktop/procguard/app/api/violations.py", line 86, in get_violation
    db.commit()
    ~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "<string>", line 2, in commit
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 1311, in commit
    self._prepare_impl()
    ~~~~~~~~~~~~~~~~~~^^
  File "<string>", line 2, in _prepare_impl
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 1286, in _prepare_impl
    self.session.flush()
    ~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4331, in flush
    self._flush(objects)
    ~~~~~~~~~~~^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4466, in _flush
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 4427, in _flush
    flush_context.execute()
    ~~~~~~~~~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/orm/unitofwork.py", line 466, in execute
    rec.execute(self)
    ~~~~~~~~~~~^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/orm/unitofwork.py", line 642, in execute
    util.preloaded.orm_persistence.save_obj(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self.mapper,
        ^^^^^^^^^^^^
        uow.states_for_mapper_hierarchy(self.mapper, False, False),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        uow,
        ^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/orm/persistence.py", line 85, in save_obj
    _emit_update_statements(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        base_mapper,
        ^^^^^^^^^^^^
    ...<3 lines>...
        update,
        ^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/orm/persistence.py", line 912, in _emit_update_statements
    c = connection.execute(
        statement, multiparams, execution_options=execution_options
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1419, in execute
    return meth(
        self,
        distilled_parameters,
        execution_options or NO_OPTIONS,
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
    return connection._execute_clauseelement(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        self, distilled_params, execution_options
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
    ret = self._execute_context(
        dialect,
    ...<8 lines>...
        cache_hit=cache_hit,
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
    return self._exec_single_context(
           ~~~~~~~~~~~~~~~~~~~~~~~~~^
        dialect, context, statement, parameters
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        e, str_statement, effective_parameters, cursor, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        cursor, str_statement, effective_parameters, context
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
    ~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/pg8000/legacy.py", line 283, in execute
    raise cls(msg)
sqlalchemy.exc.ProgrammingError: (pg8000.dbapi.ProgrammingError) {'S': 'ERROR', 'V': 'ERROR', 'C': 'P0001', 'M': 'Violations are immutable', 'W': 'PL/pgSQL function forbid_violation_mutation() line 3 at RAISE', 'F': 'pl_exec.c', 'L': '3919', 'R': 'exec_stmt_raise'}
[SQL: UPDATE violations SET triggering_filter_event_id=%s::UUID WHERE violations.violation_id = %s::UUID]
[parameters: (UUID('1c421378-01a1-4d3d-a7b5-35c010dc2a6c'), UUID('09d2dd90-7578-442b-92f9-e9861d08d3b6'))]
(Background on this error at: https://sqlalche.me/e/20/f405)
INFO:     127.0.0.1:64673 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:64679 - "GET /procedures/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:64682 - "OPTIONS /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64683 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64684 - "OPTIONS /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64685 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64684 - "GET /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64686 - "GET /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64683 - "POST /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64682 - "POST /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64682 - "OPTIONS /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A40.159Z&to_ts=2026-01-08T17%3A59%3A40.159Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64683 - "OPTIONS /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A40.147Z&to_ts=2026-01-08T17%3A59%3A40.147Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64682 - "GET /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A40.147Z&to_ts=2026-01-08T17%3A59%3A40.147Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64686 - "GET /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A40.159Z&to_ts=2026-01-08T17%3A59%3A40.159Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64686 - "OPTIONS /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64682 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64683 - "OPTIONS /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64684 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64686 - "GET /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64683 - "GET /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64685 - "POST /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64682 - "POST /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64682 - "OPTIONS /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A41.522Z&to_ts=2026-01-08T17%3A59%3A41.522Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64685 - "OPTIONS /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A41.523Z&to_ts=2026-01-08T17%3A59%3A41.523Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64682 - "GET /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A41.523Z&to_ts=2026-01-08T17%3A59%3A41.523Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64683 - "GET /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A41.522Z&to_ts=2026-01-08T17%3A59%3A41.522Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64683 - "OPTIONS /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64682 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64685 - "OPTIONS /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64686 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64683 - "GET /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64685 - "GET /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64682 - "POST /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64684 - "POST /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64682 - "OPTIONS /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A42.090Z&to_ts=2026-01-08T17%3A59%3A42.090Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64684 - "OPTIONS /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A42.089Z&to_ts=2026-01-08T17%3A59%3A42.089Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64685 - "GET /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A42.090Z&to_ts=2026-01-08T17%3A59%3A42.090Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64682 - "GET /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A42.089Z&to_ts=2026-01-08T17%3A59%3A42.089Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64682 - "OPTIONS /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64685 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64684 - "OPTIONS /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64683 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64682 - "GET /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64684 - "GET /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64685 - "POST /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64686 - "POST /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64686 - "OPTIONS /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A42.253Z&to_ts=2026-01-08T17%3A59%3A42.253Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64685 - "OPTIONS /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A42.251Z&to_ts=2026-01-08T17%3A59%3A42.251Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64684 - "GET /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A42.253Z&to_ts=2026-01-08T17%3A59%3A42.253Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64686 - "GET /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A42.251Z&to_ts=2026-01-08T17%3A59%3A42.251Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64692 - "OPTIONS /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64693 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64694 - "OPTIONS /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64695 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64694 - "GET /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64696 - "GET /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64693 - "POST /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64692 - "POST /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64692 - "OPTIONS /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A42.416Z&to_ts=2026-01-08T17%3A59%3A42.416Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64693 - "OPTIONS /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A42.415Z&to_ts=2026-01-08T17%3A59%3A42.415Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64692 - "GET /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A42.415Z&to_ts=2026-01-08T17%3A59%3A42.415Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64696 - "GET /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A42.416Z&to_ts=2026-01-08T17%3A59%3A42.416Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64696 - "OPTIONS /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64692 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64693 - "OPTIONS /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64694 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64696 - "GET /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64693 - "GET /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64695 - "POST /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64692 - "POST /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64692 - "OPTIONS /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A42.565Z&to_ts=2026-01-08T17%3A59%3A42.565Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64695 - "OPTIONS /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A42.565Z&to_ts=2026-01-08T17%3A59%3A42.565Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64693 - "GET /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A42.565Z&to_ts=2026-01-08T17%3A59%3A42.565Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64692 - "GET /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A42.565Z&to_ts=2026-01-08T17%3A59%3A42.565Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64692 - "OPTIONS /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64693 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64695 - "OPTIONS /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64696 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64692 - "GET /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64695 - "GET /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64694 - "POST /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64693 - "POST /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64693 - "OPTIONS /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A42.716Z&to_ts=2026-01-08T17%3A59%3A42.716Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64694 - "OPTIONS /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A42.717Z&to_ts=2026-01-08T17%3A59%3A42.717Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64695 - "GET /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A42.716Z&to_ts=2026-01-08T17%3A59%3A42.716Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64693 - "GET /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A42.717Z&to_ts=2026-01-08T17%3A59%3A42.717Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64693 - "OPTIONS /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64695 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64694 - "OPTIONS /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64692 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64693 - "GET /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64694 - "GET /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64695 - "POST /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64696 - "POST /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64696 - "OPTIONS /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A42.867Z&to_ts=2026-01-08T17%3A59%3A42.867Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64695 - "OPTIONS /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A42.866Z&to_ts=2026-01-08T17%3A59%3A42.866Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64694 - "GET /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A42.867Z&to_ts=2026-01-08T17%3A59%3A42.867Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64696 - "GET /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A42.866Z&to_ts=2026-01-08T17%3A59%3A42.866Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64696 - "OPTIONS /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64694 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64695 - "OPTIONS /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64693 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64695 - "GET /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64696 - "GET /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64692 - "POST /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64694 - "POST /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64694 - "OPTIONS /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A43.013Z&to_ts=2026-01-08T17%3A59%3A43.013Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64692 - "OPTIONS /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A43.014Z&to_ts=2026-01-08T17%3A59%3A43.014Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64696 - "GET /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A43.013Z&to_ts=2026-01-08T17%3A59%3A43.013Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64694 - "GET /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A43.014Z&to_ts=2026-01-08T17%3A59%3A43.014Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64694 - "OPTIONS /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64696 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64692 - "OPTIONS /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64695 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64692 - "GET /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64694 - "GET /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64693 - "POST /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64696 - "POST /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64696 - "OPTIONS /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A43.181Z&to_ts=2026-01-08T17%3A59%3A43.181Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64693 - "OPTIONS /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A43.181Z&to_ts=2026-01-08T17%3A59%3A43.181Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64694 - "GET /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A43.181Z&to_ts=2026-01-08T17%3A59%3A43.181Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64696 - "GET /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A43.181Z&to_ts=2026-01-08T17%3A59%3A43.181Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64696 - "OPTIONS /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64694 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64693 - "OPTIONS /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64692 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64696 - "GET /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64693 - "GET /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64695 - "POST /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64694 - "POST /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64694 - "OPTIONS /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A43.364Z&to_ts=2026-01-08T17%3A59%3A43.364Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64695 - "OPTIONS /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A43.365Z&to_ts=2026-01-08T17%3A59%3A43.365Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64694 - "GET /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A43.365Z&to_ts=2026-01-08T17%3A59%3A43.365Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64693 - "GET /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A43.364Z&to_ts=2026-01-08T17%3A59%3A43.364Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64693 - "OPTIONS /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64694 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64695 - "OPTIONS /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64696 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64693 - "GET /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64695 - "GET /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64694 - "POST /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64692 - "POST /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64694 - "OPTIONS /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A43.581Z&to_ts=2026-01-08T17%3A59%3A43.581Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64692 - "OPTIONS /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A43.580Z&to_ts=2026-01-08T17%3A59%3A43.580Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64695 - "GET /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A43.581Z&to_ts=2026-01-08T17%3A59%3A43.581Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64694 - "GET /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A43.580Z&to_ts=2026-01-08T17%3A59%3A43.580Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64694 - "OPTIONS /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64695 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64692 - "OPTIONS /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64693 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64694 - "GET /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64692 - "GET /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64696 - "POST /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64695 - "POST /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64695 - "OPTIONS /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A43.768Z&to_ts=2026-01-08T17%3A59%3A43.768Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64696 - "OPTIONS /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A43.768Z&to_ts=2026-01-08T17%3A59%3A43.768Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64692 - "GET /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A43.768Z&to_ts=2026-01-08T17%3A59%3A43.768Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64695 - "GET /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A43.768Z&to_ts=2026-01-08T17%3A59%3A43.768Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64695 - "OPTIONS /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64692 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64696 - "OPTIONS /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64694 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64695 - "GET /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64696 - "GET /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64692 - "POST /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64693 - "POST /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64693 - "OPTIONS /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A43.900Z&to_ts=2026-01-08T17%3A59%3A43.900Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64692 - "OPTIONS /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A43.899Z&to_ts=2026-01-08T17%3A59%3A43.899Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64696 - "GET /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A43.900Z&to_ts=2026-01-08T17%3A59%3A43.900Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64693 - "GET /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A43.899Z&to_ts=2026-01-08T17%3A59%3A43.899Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64693 - "OPTIONS /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64696 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64692 - "OPTIONS /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64695 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64692 - "GET /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64693 - "GET /compliance/compliance-reports HTTP/1.1" 200 OK
INFO:     127.0.0.1:64696 - "POST /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64694 - "POST /audit/filter-events HTTP/1.1" 200 OK
INFO:     127.0.0.1:64694 - "OPTIONS /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A44.051Z&to_ts=2026-01-08T17%3A59%3A44.051Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64696 - "OPTIONS /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A44.051Z&to_ts=2026-01-08T17%3A59%3A44.051Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64694 - "GET /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A44.051Z&to_ts=2026-01-08T17%3A59%3A44.051Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64693 - "GET /audit-logs?domain=SYSTEM&from_ts=2026-01-07T17%3A59%3A44.051Z&to_ts=2026-01-08T17%3A59%3A44.051Z HTTP/1.1" 200 OK
INFO:     127.0.0.1:64923 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:64926 - "GET /dashboard/summary HTTP/1.1" 200 OK
INFO:     127.0.0.1:64925 - "GET /dashboard/summary HTTP/1.1" 200 OK
INFO:     127.0.0.1:64925 - "GET /procedures/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:64923 - "OPTIONS /audit/filter-events HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:64930 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:64931 - "OPTIONS /audit/filter-events HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:64932 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:64932 - "OPTIONS /audit-logs?domain=SYSTEM&from_ts=2026-01-07T18%3A04%3A52.333Z&to_ts=2026-01-08T18%3A04%3A52.333Z HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:64940 - "GET /dashboard/summary HTTP/1.1" 200 OK
INFO:     127.0.0.1:64960 - "GET /procedures/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:64962 - "OPTIONS /audit/filter-events HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:64963 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:64964 - "OPTIONS /audit/filter-events HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:64965 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:65129 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:65129 - "OPTIONS /audit/filter-events HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:65130 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:65131 - "OPTIONS /audit/filter-events HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:65132 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:65131 - "OPTIONS /audit-logs?domain=SYSTEM&from_ts=2026-01-07T18%3A10%3A50.039Z&to_ts=2026-01-08T18%3A10%3A50.039Z HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:65134 - "GET /violations/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:65278 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:65278 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:65279 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:65288 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:65288 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:65289 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:65290 - "GET /dashboard/summary HTTP/1.1" 200 OK
INFO:     127.0.0.1:65289 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:65288 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:65290 - "GET /violations/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:65290 - "GET /procedures/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:65405 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:65465 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:65465 - "OPTIONS /audit/filter-events HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:65466 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:65465 - "OPTIONS /audit-logs?domain=SYSTEM&from_ts=2026-01-07T18%3A18%3A00.010Z&to_ts=2026-01-08T18%3A18%3A00.010Z HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:65467 - "OPTIONS /audit/filter-events HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:65468 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:65468 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:65468 - "OPTIONS /audit/filter-events HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:65467 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:65465 - "OPTIONS /audit/filter-events HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:65466 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:65468 - "OPTIONS /audit-logs?domain=SYSTEM&from_ts=2026-01-07T18%3A18%3A01.157Z&to_ts=2026-01-08T18%3A18%3A01.157Z HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:49170 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:49170 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:49171 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:49180 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:49180 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:49181 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:49181 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:49181 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:49180 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:49180 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:49180 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:49181 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:49181 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:49181 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:49180 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:49180 - "OPTIONS /audit/filter-events HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:49181 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:49185 - "OPTIONS /audit/filter-events HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:49186 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:49224 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:49225 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:49298 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:49298 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:49299 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 400 Bad Request
WARNING:  StatReload detected changes in 'app/api/violations.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [96096]
INFO:     Started server process [2227]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     127.0.0.1:49512 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:49512 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:49513 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:49518 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:49519 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:49528 - "GET /audit/filter-events/export?screen=AUDIT_LOGS&from_ts=2026-01-07T18%3A29%3A41.712Z&to_ts=2026-01-08T18%3A29%3A41.712Z HTTP/1.1" 409 Conflict
INFO:     127.0.0.1:49528 - "GET /favicon.ico HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:49537 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:49537 - "OPTIONS /audit/filter-events HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:49538 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:49539 - "OPTIONS /audit/filter-events HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:49540 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:49540 - "OPTIONS /audit-logs?domain=SYSTEM&from_ts=2026-01-07T18%3A29%3A44.978Z&to_ts=2026-01-08T18%3A29%3A44.978Z HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:49542 - "GET /audit/filter-events/verify HTTP/1.1" 409 Conflict
INFO:     127.0.0.1:49552 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:49552 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:49553 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:49553 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:49553 - "OPTIONS /audit/filter-events HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:49552 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:49555 - "OPTIONS /audit/filter-events HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:49556 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:49553 - "OPTIONS /audit-logs?domain=SYSTEM&from_ts=2026-01-07T18%3A29%3A58.281Z&to_ts=2026-01-08T18%3A29%3A58.281Z HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:49558 - "GET /dashboard/summary HTTP/1.1" 200 OK
INFO:     127.0.0.1:49558 - "GET /procedures/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:49558 - "GET /dashboard/summary HTTP/1.1" 200 OK
INFO:     127.0.0.1:49707 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:49708 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:49711 - "GET /dashboard/summary HTTP/1.1" 200 OK
INFO:     127.0.0.1:49711 - "GET /violations/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:49711 - "GET /procedures/ HTTP/1.1" 200 OK
WARNING:  StatReload detected changes in 'app/api/audit_timeline.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [2227]
INFO:     Started server process [3197]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  StatReload detected changes in 'app/main.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [3197]
INFO:     Started server process [3226]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     127.0.0.1:49825 - "GET /observability/circuits HTTP/1.1" 200 OK
INFO:     127.0.0.1:49842 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:49842 - "OPTIONS /audit/filter-events HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:49843 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:49844 - "OPTIONS /audit/filter-events HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:49845 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:49844 - "OPTIONS /audit-logs?domain=SYSTEM&from_ts=2026-01-07T18%3A38%3A13.299Z&to_ts=2026-01-08T18%3A38%3A13.299Z HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:49907 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:49907 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:49908 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 400 Bad Request
WARNING:  StatReload detected changes in 'app/api/audit_timeline.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [3226]
INFO:     Started server process [3754]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
SYSTEMIC FAILURE on /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline: (pg8000.dbapi.ProgrammingError) {'S': 'ERROR', 'V': 'ERROR', 'C': '42P01', 'M': 'relation "timeline_snapshots" does not exist', 'P': '13', 'F': 'parse_relation.c', 'L': '1395', 'R': 'parserOpenTable'}
[SQL: INSERT INTO timeline_snapshots (id, batch_id, timeline_json, captured_at) VALUES (%s::UUID, %s::UUID, %s::JSONB, %s::TIMESTAMP WITH TIME ZONE)]
[parameters: (UUID('df692c90-0849-4322-904b-7caaf6ccc9e0'), UUID('f1989a15-15ab-4981-9914-72ee6ba3addf'), '{"batch_id": "f1989a15-15ab-4981-9914-72ee6ba3addf", "procedure_id": "11111111-1111-1111-1111-111111111111", "procedure_version": 1, "stages": [{"nam ... (11108 characters truncated) ... ": "EOS", "deviation_id": null, "violation_id": "00000000-0000-0000-0000-000000000017", "comments": "Sample Comment"}], "deviations": [], "lirs": []}', datetime.datetime(2026, 1, 8, 18, 43, 10, 398091))]
(Background on this error at: https://sqlalche.me/e/20/f405)
[CIRCUIT] Failure recorded for /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline: ProgrammingError (1/5)
INFO:     127.0.0.1:49990 - "GET /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 500 Internal Server Error
INFO:     127.0.0.1:50008 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:50008 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:50009 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 400 Bad Request
WARNING:  StatReload detected changes in 'app/main.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [3754]
INFO:     Started server process [4201]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  StatReload detected changes in 'app/api/audit_timeline.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [4201]
INFO:     Started server process [4259]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     127.0.0.1:50127 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:50148 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:50148 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:50149 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:50149 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:50149 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:50148 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:50148 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:50148 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:50149 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:50149 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:50149 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:50148 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:50148 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:50148 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:50149 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:50149 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:50149 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:50148 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:50148 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:50148 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:50149 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:50156 - "GET /dashboard/summary HTTP/1.1" 200 OK
INFO:     127.0.0.1:50200 - "GET /dashboard/summary HTTP/1.1" 200 OK
INFO:     127.0.0.1:50251 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:50245 - "GET /dashboard/summary HTTP/1.1" 200 OK
INFO:     127.0.0.1:50245 - "GET /violations/ HTTP/1.1" 200 OK
INFO:     127.0.0.1:50258 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:50259 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:50289 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:50289 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:50290 - "OPTIONS /batches/f1989a15-15ab-4981-9914-72ee6ba3addf/timeline HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:50343 - "OPTIONS /audit/filter-events HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:50344 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:50345 - "OPTIONS /compliance/compliance-reports HTTP/1.1" 400 Bad Request
INFO:     127.0.0.1:50346 - "OPTIONS /audit/filter-events HTTP/1.1" 400 Bad Request
WARNING:  StatReload detected changes in 'app/core/circuit_breaker.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [4259]
INFO:     Started server process [5133]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  StatReload detected changes in 'app/main.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [5133]
INFO:     Started server process [5152]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  StatReload detected changes in 'app/api/audit_timeline.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [5152]
Process SpawnProcess-11:
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
    self.run()
    ~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    ~~~~~~^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/uvicorn/server.py", line 67, in run
    return asyncio_run(self.serve(sockets=sockets), loop_factory=self.config.get_loop_factory())
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 719, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/uvicorn/server.py", line 71, in serve
    await self._serve(sockets)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/uvicorn/server.py", line 78, in _serve
    config.load()
    ~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/uvicorn/config.py", line 439, in load
    self.loaded_app = import_from_string(self.app)
                      ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/uvicorn/importer.py", line 19, in import_from_string
    module = importlib.import_module(module_str)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 1026, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/Users/djtaylor/Desktop/procguard/app/main.py", line 4, in <module>
    from app.api import batches, events, procedures, audit_timeline, compliance
  File "/Users/djtaylor/Desktop/procguard/app/api/audit_timeline.py", line 105
    stages_data = []
    ^^^^^^^^^^^
SyntaxError: expected 'except' or 'finally' block
WARNING:  StatReload detected changes in 'app/api/audit_timeline.py'. Reloading...
Process SpawnProcess-12:
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/multiprocessing/process.py", line 313, in _bootstrap
    self.run()
    ~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/uvicorn/_subprocess.py", line 80, in subprocess_started
    target(sockets=sockets)
    ~~~~~~^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/uvicorn/server.py", line 67, in run
    return asyncio_run(self.serve(sockets=sockets), loop_factory=self.config.get_loop_factory())
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/asyncio/base_events.py", line 719, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/uvicorn/server.py", line 71, in serve
    await self._serve(sockets)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/uvicorn/server.py", line 78, in _serve
    config.load()
    ~~~~~~~~~~~^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/uvicorn/config.py", line 439, in load
    self.loaded_app = import_from_string(self.app)
                      ~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/uvicorn/importer.py", line 19, in import_from_string
    module = importlib.import_module(module_str)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 1026, in exec_module
  File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
  File "/Users/djtaylor/Desktop/procguard/app/main.py", line 4, in <module>
    from app.api import batches, events, procedures, audit_timeline, compliance
  File "/Users/djtaylor/Desktop/procguard/app/api/audit_timeline.py", line 105
    stages_data = []
    ^^^^^^^^^^^
SyntaxError: expected 'except' or 'finally' block
